@startuml Film Sonar - Flujo de Patrones de Dise√±o

!theme plain
skinparam backgroundColor #FEFEFE
skinparam roundcorner 20
skinparam componentStyle rectangle
skinparam classBackgroundColor #E8F4FD
skinparam interfaceBackgroundColor #FFF2CC

start

:Usuario solicita recomendaciones;

partition "üéØ STRATEGY PATTERN" {
  :RecommendationService;
  :Analiza preferencias del usuario;
  
  fork
    :GenreStrategy;
    :Calcula puntuaci√≥n por g√©neros;
  fork again
    :DirectorStrategy;
    :Calcula puntuaci√≥n por directores;
  end fork
  
  :Combina resultados de estrategias;
}

partition "üóÑÔ∏è REPOSITORY PATTERN" {
  :MovieRepository;
  :Busca pel√≠culas candidatas;
  :Aplica filtros;
  :Excluye pel√≠culas ya vistas;
}

partition "üîó OBSERVER PATTERN" {
  :ExternalRating se actualiza;
  :Notifica a Movie;
  :Movie actualiza weighted_score;
}

partition "üèóÔ∏è TEMPLATE METHOD" {
  :Api::V1::BaseController;
  :Valida autenticaci√≥n;
  :Procesa solicitud;
  :Renderiza respuesta;
}

:Devuelve recomendaciones al usuario;

stop

note as N1
  <b>Flujo de Patrones:</b>
  1. <b>Strategy:</b> M√∫ltiples algoritmos de recomendaci√≥n
  2. <b>Repository:</b> Acceso centralizado a datos
  3. <b>Observer:</b> Actualizaci√≥n autom√°tica
  4. <b>Template Method:</b> Procesamiento consistente
end note

@enduml 